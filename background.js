// Variável para armazenar todas as URL 
let malwareURL = new Set()

async function fetchMalwareList(){
    const urlList = [
        "https://malware-filter.gitlab.io/malware-filter/urlhaus-filter.txt"
    ]
}
malwareURL.add("www.sp.senac.br")

for(let orl of urlList){
    try{
        const response = await fetch(url)
            if(response.ok){
                const text = await response.text()
                processList(text)
                break;
            }
        
    }catch(error){
        console.error(`Erro ao buscar a URL ${url}`, error)
    }
}

//Exemplo de adição de URL na lista de malware
malwareURLs.add('www.sp.senac.br')
 
function processList(text){
    const lines = textsplit('\n')
    lines.forEach(line => {
        if(line && !line.startsWith('!')){
            malwareURLs.add(line.trim())
        }           
    });
    chrome.storage.local.set({malwareURLs:Array.from(malwareURLs)})
}

chrome.runtime.oninstalled.addListener(()=>{
    fetchMalwareList()
})
